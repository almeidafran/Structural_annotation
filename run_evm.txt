# índice do genoma
miniprot -d genome.mpi genome.fasta

# alinhamento proteína->genoma com saída GFF3
miniprot -t 16 --gff genome.mpi proteins.faa > miniprot.gff3


###padronizar os gff
awk 'BEGIN{OFS="\t"} $0 ~ /^#/ {print; next} {$2="braker"; print}' braker.gff3 > braker.src.gff3
awk 'BEGIN{OFS="\t"} $0 ~ /^#/ {print; next} {$2="helixer"; print}' helixer.gff3 > helixer.src.gff3
awk 'BEGIN{OFS="\t"} $0 ~ /^#/ {print; next} {$2="miniprot"; print}' miniprot.gff3 > miniprot.src.gff3
# PASA já costuma vir com source "PASA" ou similar; pode manter e usar esse rótulo no weights.


###contriuir  weights.txt 
# classe              tipo(source no GFF3)        peso
TRANSCRIPT            PASA                        10
PROTEIN               miniprot                    5
ABINITIO_PREDICTION   braker                      4
ABINITIO_PREDICTION   helixer                     3

##Run EVM
 EVidenceModeler \
        --sample_id Vtub_hapA_evm \
        --genome ../../../Vtub.hapA.v1.munged/Vtub.hapA.v1.softmasked.fasta \
        --gene_predictions braker3_viri_hapA.src.gff3,helixer_hapA.src.gff3 \
        --protein_alignments miniprot.src.gff3 \
        --transcript_alignments ../result_pasa_viri_update/pasa_hpA_viri.sqlite.pasa_assemblies.gff3 \
        --segmentSize 100000 \
        --overlapSize 10000
